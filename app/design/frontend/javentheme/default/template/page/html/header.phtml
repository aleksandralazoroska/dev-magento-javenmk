<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magento.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magento.com for more information.
 *
 * @category    design
 * @package     rwd_default
 * @copyright   Copyright (c) 2006-2017 X.commerce, Inc. and affiliates (http://www.magento.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
/**
 * @var Mage_Page_Block_Html_Header $this
 */
?>

<!--
<div class="header-language-background">
    <div class="header-language-container">
        <div class="store-language-container">
            <?php //echo $this->getChildHtml('store_language') ?>
        </div>

        <?php //echo $this->getChildHtml('currency_switcher') ?>

        <p class="welcome-msg"><?php //echo $this->getChildHtml('welcome') ?> <?php //echo $this->getChildHtml('accountLinks') ?></p>
    </div>
</div>
-->

<?php $useragent = $_SERVER['HTTP_USER_AGENT']; ?>

<header id="header" class="page-header">
  
  <?php // Mobile version ?>
  <?php if(preg_match("/(android|avantgo|blackberry|bolt|boost|cricket|docomo|fone|hiptop|mini|mobi|palm|phone|pie|tablet|up\.browser|up\.link|webos|wos)/i", $_SERVER["HTTP_USER_AGENT"])): ?>

    <div class="page-header-container">
      <a class="logo" href="<?php echo $this->getUrl('') ?>">
          <img src="<?php echo $this->getLogoSrc() ?>" alt="<?php echo $this->getLogoAlt() ?>" class="large" />
          <img src="<?php echo $this->getLogoSrcSmall() ?>" alt="<?php echo $this->getLogoAlt() ?>" class="small" />
      </a>
      <div class="skip-links">
        <div class="account-cart-wrapper">
          <div class="store-language-container">
            <?php echo $this->getChildHtml('store_language') ?>
          </div>
        </div>
        <?php if( !Mage::getSingleton( 'customer/session' )->isLoggedIn() ): ?>
          <a id="header-mobile-links-btn" class="header-mobile-links-btn">
            <img class="header-mobile-menu" width="60" src="<?php echo $this->getSkinUrl('images/mobile_menu_button.png'); ?>" />
          </a>
        <?php else: ?>
          <div class="header-top-name" id="header-top-account">
            <img class="header-top-account-img" height="45" width="45" src="<?php echo $this->getSkinUrl('images/account-circle.svg'); ?>" />
            <img class="header-top-account-arrow" height="25" width="25" src="<?php echo $this->getSkinUrl('images/menu-down.svg'); ?>" />
          </div>
        <?php endif; ?>
      </div>
    </div>

    <?php if( !Mage::getSingleton( 'customer/session' )->isLoggedIn() ): ?>

    <div style="display: none" class="header-mobile-links">
      <a class="button mobile-header" id="login-button" href="<?php echo $this->helper('customer')->getAccountUrl(); ?>" data-target-element="#header-account" class="skip-link skip-account">
          <span class="icon"></span>
          <span class="label"><?php echo $this->__('Login'); ?></span>
      </a>
      <a class="button mobile-header" href="<?php echo $this->helper('customer')->getRegisterUrl(); ?>" data-target-element="#header-account" class="skip-link skip-account">
          <span class="icon"></span>
          <span class="label"><?php echo $this->__('Register'); ?></span>
      </a>
    </div>

    <?php else: ?>

      <div class="header-top-links" id="header-top-links" style="display: none">
        <ul>
          <li><a href="<?php echo Mage::getUrl('customer/account/index/'); ?>"><?php echo $this->__("My Account"); ?></a></li>
          <li><a href="<?php echo Mage::getUrl('customerasaproduct'); ?>"><?php echo $this->__("My Page"); ?></a></li>
          <li><a href="<?php echo Mage::getUrl('customer/account/logout'); ?>"><?php echo $this->__("Log Out"); ?></a></li>
        </ul>
      </div>

    <?php endif; ?>

  <?php // Desktop version ?>
  <?php else: ?>

    <div class="page-header-container">
        <a class="logo" href="<?php echo $this->getUrl('') ?>">
            <img src="<?php echo $this->getLogoSrc() ?>" alt="<?php echo $this->getLogoAlt() ?>" class="large" />
            <img src="<?php echo $this->getLogoSrcSmall() ?>" alt="<?php echo $this->getLogoAlt() ?>" class="small" />
        </a>

        <div class="skip-links">

            <div class="account-cart-wrapper">

                <a href="<?php echo Mage::getBaseUrl(); ?>">
                  <img class="header-home-circle" height="45" width="45" src="<?php echo $this->getSkinUrl('images/home-circle.svg'); ?>" />
                </a>
                <div class="store-language-container">
                  <?php echo $this->getChildHtml('store_language') ?>
                </div>

                <?php if( !Mage::getSingleton( 'customer/session' )->isLoggedIn() ): ?>

                  <a class="button" id="login-button" href="<?php echo $this->helper('customer')->getAccountUrl(); ?>" data-target-element="#header-account" class="skip-link skip-account">
                      <span class="icon"></span>
                      <span class="label"><?php echo $this->__('Login'); ?></span>
                  </a>
                  <a class="button" href="<?php echo $this->helper('customer')->getRegisterUrl(); ?>" data-target-element="#header-account" class="skip-link skip-account">
                      <span class="icon"></span>
                      <span class="label"><?php echo $this->__('Register'); ?></span>
                  </a>

                <?php else: ?>

                  <div class="header-top-name" id="header-top-account">
                    <p><?php echo Mage::getSingleton('customer/session')->getCustomer()->getName(); ?></p>
                    <img class="header-top-account-img" height="45" width="45" src="<?php echo $this->getSkinUrl('images/account-circle.svg'); ?>" />
                    <img class="header-top-account-arrow" height="25" width="25" src="<?php echo $this->getSkinUrl('images/menu-down.svg'); ?>" />
                  </div>
                  <div class="header-top-links" id="header-top-links" style="display: none">
                    <ul>
                      <li><a href="<?php echo Mage::getUrl('customer/account/index/'); ?>"><?php echo $this->__("My Account"); ?></a></li>
                      <li><a href="<?php echo Mage::getUrl('customerasaproduct'); ?>"><?php echo $this->__("My Page"); ?></a></li>
                      <li><a href="<?php echo Mage::getUrl('customer/account/logout'); ?>"><?php echo $this->__("Log Out"); ?></a></li>
                    </ul>
                  </div>

                <?php endif; ?>

                <div class="header-minicart">
                    <?php echo $this->getChildHtml('minicart_head'); ?>
                </div>
            </div>

        </div>

    </div>

  <?php endif; ?>

</header>
<?php
  $atributeCode = 'city';
  $attribute = Mage::getModel('eav/config')->getAttribute('catalog_product',$atributeCode);
  $options = $attribute->getSource()->getAllOptions();
  $result = array();
  $result['city'] = 0;
?>
<?php $controllerName = Mage::app()->getFrontController()->getRequest()->getControllerName(); ?>
<?php if( $controllerName == 'category' || $controllerName == 'product' || $controllerName == 'result' || $controllerName == 'advanced'): ?>
  <!--
  <div class="page-header-search">
    <div class="home-container-poznat-search">
      <form id="search_mini_form" action="<?php //echo $this->helper('catalogSearch')->getResultUrl() ?>" method="get">
          <fieldset>
              <div class="mini-search">
                <input id="search" type="text" class="search-input" name="<?php //echo $this->helper('catalogSearch')->getQueryParamName() ?>" value="<?php //echo $this->helper('catalogSearch')->getEscapedQueryText() ?>" />
                <select name="city_attr" id="city_attr" class="search-select">
                  <?php //foreach($options as $key => $value): ?>
                    <option value="<?php //echo $value['label']; ?>" <?php //if($key == $result['city']): ?> selected="selected" <?php //endif; ?> ><?php //if ($key == 0) { echo $this->__("Macedonia"); } else { echo $value['label']; }; ?></option>
                  <?php //endforeach; ?>
                </select>
                <div class="search-submit-parent">
                  <input type="submit" class="search-submit" value="" alt="<?php //echo $this->__('Search') ?>" />
                </div>
                <div id="search_autocomplete" class="search-autocomplete"></div>
                <script type="text/javascript">
                  //<![CDATA[
                      var searchForm = new Varien.searchForm('search_mini_form', 'search', '<?php //echo $this->__('Search') ?>');
                      searchForm.initAutocomplete('<?php //echo $this->helper('catalogSearch')->getSuggestUrl() ?>', 'search_autocomplete');
                  //]]>
                </script>
              </div>
          </fieldset>
      </form>
    </div>
  </div>
  -->
<div class="page-header-search">
  <div class="home-container-poznat-search">
    <?php $block = Mage::app()->getLayout()->createBlock('catalogsearch/advanced_form'); ?>
    <form action="<?php echo Mage::getUrl('catalogsearch/advanced/result/') ?>" method="get" id="form-validate">
        <div class="fieldset advanced-search">
            <ul class="form-list" id="advanced-search-list">
                <?php foreach ($block->getSearchableAttributes() as $_attribute): ?>
                <?php $_code = $_attribute->getAttributeCode() ?>
                <li>
                    <?php if ($_code == 'description'): ?>
                      <input type="text" name="description" id="description" onfocus="if(this.value == '<?php echo $this->__('Search') ?>') { this.value = ''; }" value="<?php echo $this->__('Search') ?>" title="<?php echo $block->escapeHtml($block->getAttributeLabel($_attribute)) ?>"  class="input-text <?php echo $block->getAttributeValidationClass($_attribute) ?>" maxlength="<?php echo $maxQueryLength;?>" />
                    <?php elseif ($_code == 'city_attr'): ?>
                      <select name="city_attr" id="city_attr" class="search-select">
                          <?php foreach($options as $key => $value): ?>
                              <option value="<?php echo $value['label']; ?>" <?php if($key == $result['city']): ?> selected="selected" <?php endif; ?> ><?php if ($key == 0) { echo $this->__("Macedonia"); } else { echo $value['label']; }; ?></option>
                          <?php endforeach; ?>
                      </select>
                    <?php endif; ?>
                </li>
                <?php endforeach; ?>
            </ul>
            <div class="search-submit-parent">
                <input type="submit" class="search-submit" value="" alt="<?php echo $this->__('Search') ?>" />
            </div>
            <script type="text/javascript">decorateList('advanced-search-list')</script>
        </div>
    </form>
  </div>
</div>
<?php endif; ?>


<?php echo $this->getChildHtml('topContainer'); ?>

<script type="text/javascript">

  $j(document).ready(function() {
    $j("#header-top-account").click(function(){
      $j("#header-top-links").toggle();
    });
  });

  $j(document).ready(function() {
    $j("#footer-arrow-up").click(function(){
      $j("html, body").animate({ scrollTop: 0 }, "slow");
      return false;
    });
  });

  // Show / Hide Login div
  $j(document).ready(function() {
    $j("#header-mobile-links-btn").click(function(){
      $j(".header-mobile-links").toggle();
    });
  });

</script>
